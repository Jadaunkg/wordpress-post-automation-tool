{% extends "_base.html" %}

{% block title %}Register - WP Automator{% endblock %}

{% block head_extra %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}"> {% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <h2><i class="fas fa-user-plus"></i> Create Your Account</h2>

        <div id="auth-error-message" class="flash-message flash-error" style="display:none;"></div>
        <div id="auth-success-message" class="flash-message flash-success" style="display:none;"></div>

        <form id="registerForm">
            <div class="form-group">
                <label for="registerUsername"><i class="fas fa-user"></i> Username (Display Name)</label>
                <input type="text" id="registerUsername" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="registerEmail"><i class="fas fa-envelope"></i> Email Address</label>
                <input type="email" id="registerEmail" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="registerPassword"><i class="fas fa-lock"></i> Password</label>
                <div class="password-wrapper">
                    <input type="password" id="registerPassword" class="form-control" required minlength="6">
                    <button type="button" class="password-toggle" onclick="togglePasswordVisibility('registerPassword', this)">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <small class="form-text text-muted">Password should be at least 6 characters long.</small>
            </div>
             <div class="form-group">
                <label for="registerPasswordConfirm"><i class="fas fa-lock"></i> Confirm Password</label>
                <div class="password-wrapper">
                    <input type="password" id="registerPasswordConfirm" class="form-control" required minlength="6">
                     <button type="button" class="password-toggle" onclick="togglePasswordVisibility('registerPasswordConfirm', this)">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
            </div>
            <button type="submit" class="btn-auth"><i class="fas fa-spinner fa-spin" id="registerSpinner" style="display:none; margin-right: 5px;"></i>Register</button>
        </form>

        <div class="social-login-divider">
            <span>OR</span>
        </div>
        
        <button id="googleSignUpButton" class="btn-google">
            <i class="fab fa-google" style="margin-right: 5px;"></i> Sign up with Google
        </button>

        <p class="auth-links">
            Already have an account? <a href="{{ url_for('login') }}">Login here</a>
        </p>
    </div>
</div>
{% endblock %}

{% block scripts_extra %}
<script src="{{ url_for('static', filename='js/firebase-init.js') }}"></script>
<script>
    // Specific event listeners for register page
    const registerForm = document.getElementById('registerForm');
    if (registerForm) {
        registerForm.addEventListener('submit', handleRegister);
    }

    const googleSignUpButton = document.getElementById('googleSignUpButton');
    if (googleSignUpButton) {
        googleSignUpButton.addEventListener('click', signInWithGoogle); // Re-use the same Google sign-in function
    }
</script>
{% endblock %}